<!DOCTYPE html>
<html>
<head>
<title>Real-Time Tic Tac Toe</title>
<style>
  #board { display:grid; grid-template-columns:repeat(3,100px); gap:5px; margin:20px auto; }
  .cell { width:100px; height:100px; font-size:50px; display:flex; align-items:center; justify-content:center; border:2px solid #333; cursor:pointer; }
</style>
</head>
<body>
<h1>Real-Time Tic Tac Toe</h1>
<label>Room ID: <input type="text" id="roomID"></label>
<label>Player Name: <input type="text" id="playerName"></label>
<button id="joinBtn">Join Room</button>

<div id="board" style="display:none;"></div>
<div id="status"></div>

<script>
let ws;
let mySymbol = "X";
let board = ["","","","","","","","",""];
let roomID, playerName;

document.getElementById("joinBtn").addEventListener("click", ()=>{
  roomID = document.getElementById("roomID").value.trim();
  playerName = document.getElementById("playerName").value.trim();
  if(!roomID||!playerName){ alert("Enter name and room"); return; }
ws = new WebSocket("wss://tic-tac-toe-server-57go.onrender.com");


  ws.onopen = ()=> {
    ws.send(JSON.stringify({ type:"join", roomID, player: playerName }));
  }

  ws.onmessage = (msg)=>{
    const data = JSON.parse(msg.data);
    if(data.type==="joined") mySymbol = data.symbol;
    if(data.type==="update") { board = data.board; updateBoard(data.board); document.getElementById("status").innerText="Current Turn: "+data.currentPlayer; }
    if(data.type==="end") { document.getElementById("status").innerText="Winner: "+data.winner; }
  }

  document.getElementById("board").style.display="grid";
  createBoard();
});

function createBoard(){
  const boardDiv = document.getElementById("board");
  boardDiv.innerHTML="";
  for(let i=0;i<9;i++){
    const cell = document.createElement("div");
    cell.className="cell";
    cell.id="cell"+i;
    cell.addEventListener("click", ()=> makeMove(i));
    boardDiv.appendChild(cell);
  }
  updateBoard(board);
}

function updateBoard(b){
  for(let i=0;i<9;i++){
    document.getElementById("cell"+i).innerText = b[i];
  }
}

function makeMove(index){
  if(board[index]!=="" || !ws) return;
  ws.send(JSON.stringify({ type:"move", roomID, player: playerName, move:index }));
}
</script>
</body>
</html>

